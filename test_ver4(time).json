{
  "name": "test_ver4(time)",
  "nodes": [
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hour": 9,
              "minute": 3
            }
          ]
        }
      },
      "id": "9294f1c5-df60-4993-b1fe-35319a69ffa7",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [
        -464,
        272
      ]
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss?hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "id": "a136877c-4204-4de6-969c-bf4b982f11dc",
      "name": "RSS Feed Read - ë©”ì¸ ë‰´ìŠ¤",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        96,
        -336
      ]
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=%EB%A1%9C%EB%B4%87&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "id": "96b6234a-3032-493d-bc4b-3bcb40b19f53",
      "name": "RSS Feed Read - ë¡œë´‡",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        96,
        272
      ]
    },
    {
      "parameters": {
        "functionCode": "// ë‰´ìŠ¤ í•„í„°ë§ + ê°€ì¤‘ì¹˜ ê³„ì‚° + ì¶œì²˜ë³„ ê·¸ë£¹í™” + ì •ë ¬\nconst start = new Date();\nstart.setDate(start.getDate() - 1);\nstart.setHours(9, 3, 0, 0);\n\nconst end = new Date();\nend.setHours(9, 2, 0, 0);\n\nconst keywordWeights = {\n  'ai ê¸°ë³¸ë²•': 6,\n  'ai ì •ì±…': 5,\n  'ai ê·œì œ': 5,\n  'ai ë²•ì•ˆ': 5,\n\n  // ì¼ë°˜ AI\n  'ai': 2,\n  'ì¸ê³µì§€ëŠ¥': 2,\n  'rag': 2,\n\n  // ê¸°ìˆ \n  'LLM': 2,\n  'í”¼ì§€ì»¬ ai': 2,\n  'ë¡œë´‡': 2,\n\n  // ì‹ ê¸°ìˆ Â·ë””ë°”ì´ìŠ¤\n  'ì›¨ì–´ëŸ¬ë¸”': 2,\n  'êµ¬ê¸€ ê¸€ë¼ìŠ¤': 2,\n  'ìŠ¤ë§ˆíŠ¸ ê¸€ë˜ìŠ¤': 2\n};\n\n// items: ì´ì „ ë…¸ë“œì—ì„œ ë“¤ì–´ì˜¨ ë‰´ìŠ¤ ë°°ì—´\nconst newsItems = items.map(item => item.json);\n\nlet processedItems = newsItems.map(item => {\n  const pubDate = new Date(item.pubDate || item.isoDate);\n  if (pubDate < start || pubDate > end) return null;\n\n  let title = item.title || 'ì œëª© ì—†ìŒ';\n  const link = item.link || '#';\n  let text = (title + ' ' + (item.content || '')).toLowerCase();\n  let weight = 0;\n  let matchedKeywords = [];\n\n  for (const [kw, w] of Object.entries(keywordWeights)) {\n    const pattern = kw.toLowerCase().replace(/ /g, '\\\\s*');\n    const matches = text.match(new RegExp(pattern, 'gi'));\n    if (matches) {\n      weight += matches.length * w;\n      matchedKeywords.push(kw);\n    }\n  }\n\n  if (weight < 10) return null;\n\n  // ì¶œì²˜(source) ê²°ì •\n  let source = '';\n  const dashIndex = title.lastIndexOf(' - ');\n  if (dashIndex !== -1) {\n    source = title.substring(dashIndex + 3).trim();\n    title = title.substring(0, dashIndex).trim();\n  }\n\n  // ì§€ë””ë„·ì½”ë¦¬ì•„ í”¼ë“œ URLì´ë©´ í‘œì‹œ ì´ë¦„ ë³€ê²½\n  if (link.includes('feeds.feedburner.com/zdkorea')) {\n    source = 'ì§€ë””ë„·ì½”ë¦¬ì•„';\n  }\n\n  // ë³¸ë¬¸ ì•ˆ ì§€ë””ë„·ì½”ë¦¬ì•„ í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ source ì§€ì •\n  const contentText = ((item.content || '') + ' ' + (item.description || '')).toLowerCase();\n  if (contentText.includes('ì§€ë””ë„·ì½”ë¦¬ì•„')) {\n    source = 'ì§€ë””ë„·ì½”ë¦¬ì•„';\n  }\n\n  // sourceê°€ ì•„ì§ ë¹„ì–´ìˆìœ¼ë©´ ë§í¬ì—ì„œ ì¶”ì¶œ, ì—†ìœ¼ë©´ ì¶œì²˜ ë¯¸ìƒ\n  if (!source) {\n    try {\n      source = new URL(link).hostname.replace('www.', '');\n    } catch (e) {\n      source = 'ì¶œì²˜ ë¯¸ìƒ';\n    }\n  }\n\n  return { source, title, link, weight, matchedKeywords };\n}).filter(item => item !== null);\n\n// ì¤‘ë³µ ì œê±° (link ë˜ëŠ” title ê¸°ì¤€)\nprocessedItems = processedItems.filter((item, index, self) =>\n  index === self.findIndex(t => t.link === item.link || t.title === item.title)\n);\n\n// ì¶œì²˜ë³„ ê·¸ë£¹í™” + ê°€ì¤‘ì¹˜ ìˆœ ì •ë ¬\nconst sourceGroups = new Map();\nfor (const item of processedItems) {\n  if (!sourceGroups.has(item.source)) sourceGroups.set(item.source, []);\n  sourceGroups.get(item.source).push(item);\n}\n\nfor (const [source, articles] of sourceGroups.entries()) {\n  articles.sort((a, b) => b.weight - a.weight);\n}\n\n// ê·¸ë£¹ ìµœê³  ì ìˆ˜ ê¸°ì¤€ ì •ë ¬\nconst sortedSources = Array.from(sourceGroups.entries())\n  .map(([source, articles]) => ({\n    source,\n    articles,\n    maxWeight: Math.max(...articles.map(a => a.weight))\n  }))\n  .sort((a, b) => b.maxWeight - a.maxWeight);\n\nreturn [{ json: { sortedSources } }];\n"
      },
      "id": "ff785c69-dfdc-4109-a458-75d211f47d48",
      "name": "Process Feeds",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        816,
        288
      ]
    },
    {
      "parameters": {
        "fromEmail": "osangeun404@gmail.com",
        "toEmail": "silver_oh@kcisa.kr",
        "subject": "={{$now.format(\"DD\")}} AI ë‰´ìŠ¤ë ˆí„° ğŸ“ˆ",
        "html": "={{$json.emailBody}}",
        "options": {}
      },
      "id": "c57cbabd-b6bb-4429-8986-8773dcbbefaa",
      "name": "Send Email",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 1,
      "position": [
        1264,
        288
      ],
      "credentials": {
        "smtp": {
          "id": "AeZF78ce7ROf5eJV",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "numberInputs": 10
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        560,
        160
      ],
      "id": "2e505ec9-e7d7-41f3-98ec-0ee16b6ea6e1",
      "name": "Merge"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=AI+%EA%B8%B0%EB%B3%B8%EB%B2%95&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        592
      ],
      "id": "7c8d722a-2494-48ff-a992-18a460669bac",
      "name": "RSS Feed Read - AIê¸°ë³¸ë²•"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=rag&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        736
      ],
      "id": "66399594-c08a-4d79-89de-737a2170b6e5",
      "name": "RSS Feed Read - RAG"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=AI&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "id": "eaaaaf6f-4cdf-4695-af07-d2fd972f1c51",
      "name": "RSS Feed Read - AI",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        96,
        -192
      ]
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        -32
      ],
      "id": "ebfedf02-8dca-4adc-8b95-3189f7431cc0",
      "name": "RSS Feed Read - ì¸ê³µì§€ëŠ¥"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=%EC%83%9D%EC%84%B1%ED%98%95+AI&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        128
      ],
      "id": "2b761bda-7420-4e33-b6cd-5deba0e943af",
      "name": "RSS Feed Read - ìƒì„±í˜• AI"
    },
    {
      "parameters": {
        "url": "https://feeds.feedburner.com/zdkorea",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        896
      ],
      "id": "87c2145d-d1ee-43c2-88a9-8b32eeadc1b1",
      "name": "RSS Feed Read - ì§€ë””ë„·"
    },
    {
      "parameters": {
        "jsCode": "// ì´ì „ ë…¸ë“œì—ì„œ sortedSources ê°€ì ¸ì˜¤ê¸°\nconst sortedSources = items[0].json.sortedSources;\n\nlet htmlList = '';\nfor (const { source, articles } of sortedSources) {\n  htmlList += `<h4 style=\"margin-top: 25px;\">ğŸ“° ${source}</h4><ul>`;\n  for (const article of articles) {\n    htmlList += `\n      <li style=\"margin-bottom: 10px;\">\n        <a href=\"${article.link}\" target=\"_blank\" style=\"color: #2c3e50; font-weight: bold;\">\n          ${article.title} (ì ìˆ˜: ${article.weight}, í‚¤ì›Œë“œ: ${article.matchedKeywords.join(', ')})\n        </a>\n      </li>\n    `;\n  }\n  htmlList += '</ul>';\n}\n\nconst finalEmailBody = `\n<h3>ì•ˆë…•í•˜ì„¸ìš”! ë§¤ì¼ 9ì‹œì— ë§Œë‚˜ëŠ” ë”°ëˆë”°ëˆí•œ AI ë‰´ìŠ¤ ì •ë¦¬ë³¸ì…ë‹ˆë‹¤ ğŸ¤–âœ¨</h3>\n<p>ì§€ë‚œ í•˜ë£¨ ë™ì•ˆ(ì „ì¼ ì˜¤ì „ 9ì‹œ ~ ê¸ˆì¼ ì˜¤ì „ 9ì‹œ) ì£¼ìš” ì–¸ë¡ ì‚¬ì—ì„œ ë‹¤ë£¬ ê¸°ì‚¬ë¥¼ ì¶œì²˜ë³„ë¡œ ëª¨ì•„ë´¤ìŠµë‹ˆë‹¤.<br>\n<p>â€» ìˆ˜ì‹ ê±°ë¶€ / í‚¤ì›Œë“œ ì¶”ê°€Â·ê°œì„  ì˜ê²¬: silver_oh@kcisa.kr</p>\n<p>â€» í”¼ë“œ ê°œì„  ì‘ì—… ì§„í–‰ ì¤‘ğŸ› ï¸(1.4.0.ì—…ë°ì´íŠ¸) <a href=\"https://github.com/osangeun404/n8n-AI-Stream\">\në¦´ë¦¬ì¦ˆ ë…¸íŠ¸ğŸ“</a></p>\n${htmlList}<br>\n<h3>ì˜¤ëŠ˜ë„ ì¢‹ì€ í•˜ë£¨ ë³´ë‚´ì„¸ìš”! í•„ìš”í•  ë• ì–¸ì œë“  AI ë‰´ìŠ¤ê°€ ë‹¬ë ¤ê°‘ë‹ˆë‹¤ ğŸš€</h3>\n`;\n\nreturn [{ json: { emailBody: finalEmailBody } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1056,
        288
      ],
      "id": "a5a91b39-8a4d-4bc4-ae6a-dad6836aedeb",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=%EC%A0%95%EC%B1%85+OR+%EA%B7%9C%EC%A0%9C+OR+%EB%B2%95&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "id": "a17eaba5-caf0-4b7d-84c9-0e8397bd36d6",
      "name": "RSS Feed Read - ì •ì±…ê·œì œ",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        96,
        432
      ]
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/search?q=%ED%94%BC%EC%A7%80%EC%BB%AC+AI+OR+%22%EA%B5%AC%EA%B8%80+%EA%B8%80%EB%9D%BC%EC%8A%A4%22+OR+%22%EC%8A%A4%EB%A7%88%ED%8A%B8+%EA%B8%80%EB%9E%98%EC%8A%A4%22&hl=ko&gl=KR&ceid=KR:ko",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        96,
        1072
      ],
      "id": "715a5987-b367-487a-8f32-4a1630f5dc22",
      "name": "RSS Feed Read - í”¼ì§€ì»¬, ê¸€ë¼ìŠ¤ ë“±"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "RSS Feed Read - ë©”ì¸ ë‰´ìŠ¤",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - AI",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - ë¡œë´‡",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - ì •ì±…ê·œì œ",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - AIê¸°ë³¸ë²•",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - RAG",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - ìƒì„±í˜• AI",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - ì¸ê³µì§€ëŠ¥",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - ì§€ë””ë„·",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Feed Read - í”¼ì§€ì»¬, ê¸€ë¼ìŠ¤ ë“±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Feed Read - ë©”ì¸ ë‰´ìŠ¤": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Feed Read - ë¡œë´‡": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Process Feeds": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Process Feeds",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Feed Read - AIê¸°ë³¸ë²•": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 6
          }
        ]
      ]
    },
    "RSS Feed Read - RAG": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 7
          }
        ]
      ]
    },
    "RSS Feed Read - AI": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "RSS Feed Read - ìƒì„±í˜• AI": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "RSS Feed Read - ì¸ê³µì§€ëŠ¥": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "RSS Feed Read - ì§€ë””ë„·": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 8
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Send Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Feed Read - ì •ì±…ê·œì œ": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 5
          }
        ]
      ]
    },
    "RSS Feed Read - í”¼ì§€ì»¬, ê¸€ë¼ìŠ¤ ë“±": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 9
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f1e4ea88-0724-4bfd-b5a9-6248abf045d3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "b43f27d40623084bcf6e4d728866371676af477b4ddc3175f9097d40527fcc5e"
  },
  "id": "BXugu5BWhmD54bbx",
  "tags": []
}